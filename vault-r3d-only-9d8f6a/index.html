<!doctype html><html lang="pl"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>?</title><meta name="robots" content="noindex,nofollow"/><style>:root{--bg:#0a0a0a;--fg:#f3f3f3;--muted:#9a9a9a;--card:rgba(0,0,0,.55);--accent:#ff1a1a;--stroke:rgba(255,255,255,.08);--glow:0 0 24px rgba(255,26,26,.25);--font:ui-sans-serif,system-ui,-apple-system,Segoe UI,Inter,Roboto,Arial,sans-serif}*{box-sizing:border-box}html,body{height:100%}body{margin:0;font:16px/1.5 var(--font);color:var(--fg);background:var(--bg);display:grid;place-items:center}main.card{width:min(880px,92vw);padding:28px;border-radius:12px;background:var(--card);border:1px solid var(--stroke);box-shadow:0 12px 40px rgba(0,0,0,.6)}h1{margin:0 0 8px;font-size:20px}p{margin:0 0 16px;color:var(--muted)}.gate{display:flex;gap:10px;margin-top:14px}.pin{flex:1;padding:12px 14px;border-radius:10px;border:1px solid var(--stroke);background:transparent;color:var(--fg);outline:none;font-size:16px}.btn{padding:12px 14px;border-radius:10px;border:1px solid var(--stroke);background:linear-gradient(180deg, rgba(255,26,26,.12), rgba(255,26,26,.06));color:var(--fg);cursor:pointer}.btn:hover{box-shadow:var(--glow);border-color:var(--accent);transform:translateY(-1px)}.msg{margin-top:10px;color:#ffb3b3;font-size:14px;min-height:18px}</style></head><body><main class="card" role="main" aria-labelledby="t"><p>Wpisz hasło, żeby przejść dalej.</p><div class="gate"><input id="p" class="pin" type="password" inputmode="text" placeholder="Wpisz hasło" autocomplete="off" aria-label="Hasło"/><button id="b" class="btn" aria-label="Wejdź">Wejdź</button></div><div id="m" class="msg"></div><script>
(() => {
  'use strict';
  const d = document, p = d.getElementById('p'), btn = d.getElementById('b'), msg = d.getElementById('m');
  const ITER = 200000;
  const ENTRIES = [
    {
      salt: "oZ7bzZfZuBNJnr6HsHcdAg==",
      iv: "q+7qOFzi73M1vNSN",
      ct: "Nufafun4ARmYwiyJUasx/8OjIfumGPf5i4R8O4G5Z97hSaIxd8/7eJYZet4wujhBxs1cN03nkgOazzDueixarVWy9Kmm9WSAXoiBdg=="
    },
    {
      salt: "ly1HTdhRh+scGC526uFJbg==",
      iv: "tHATiKSSHeaoygV0",
      ct: "CAjOmrPY7Da9Lhonu7Lbx1Koj8OJZldyMPtL8fjSRtfXVc0TQMlov31wKTy2rG88BOPilgkRK03vZA=="
    }
  ];
  const MAX = 5, LOCK_MS = 30000;
  let fails = 0;
  const enc = new TextEncoder(), dec = new TextDecoder();
  const b64dec = s => Uint8Array.from(atob(s), c => c.charCodeAt(0));
  const TOKEN_KEY = "dreiji.once.token";
  const PATH_KEY = "dreiji.once.path";
  function ss(k, v) { try { sessionStorage.setItem(k, v) } catch (e) { } }
  function gs(k) { try { return sessionStorage.getItem(k) } catch (e) { return null } }
  function rm(k) { try { sessionStorage.removeItem(k) } catch (e) { } }
  rm(TOKEN_KEY);
  rm(PATH_KEY);
  let until = Number(gs("vlt_lock") || 0);
  if (until > Date.now()) msg.textContent = `(${Math.ceil((until - Date.now()) / 1e3)}s)`; else { rm("vlt_lock"); until = 0; }

  async function deriveKey(pass, salt) {
    const baseKey = await crypto.subtle.importKey("raw", enc.encode(pass), { name: "PBKDF2" }, false, ["deriveKey"]);
    return crypto.subtle.deriveKey({ name: "PBKDF2", hash: "SHA-256", salt, iterations: ITER }, baseKey, { name: "AES-GCM", length: 256 }, false, ["decrypt"]);
  }

  async function tryOpen(pass) {
    for (const entry of prepared) {
      try {
        const key = await deriveKey(pass, entry.salt);
        const pt = await crypto.subtle.decrypt({ name: "AES-GCM", iv: entry.iv }, key, entry.ct);
        return dec.decode(pt);
      } catch (e) {
        // try next entry
      }
    }
    return null;
  }

  async function run() {
    const now = Date.now();
    if (now < until) { msg.textContent = `(${Math.ceil((until - now) / 1e3)}s)`; return; }
    const v = (p.value || "").trim();
    if (!v) { msg.textContent = "Wpisz haslo."; return; }
    const url = await tryOpen(v);
    if (url) {
      msg.textContent = "";
      rm("vlt_lock");
      const target = (() => {
        try {
          return new URL(url, location.href);
        } catch (e) {
          return new URL(String(url), location.href);
        }
      })();
      try {
        const tokenBytes = crypto.getRandomValues(new Uint8Array(12));
        const token = Array.from(tokenBytes, b => b.toString(16).padStart(2, '0')).join('');
        const cleanPath = target.pathname.replace(/\/+$/, '');
        ss(TOKEN_KEY, token);
        ss(PATH_KEY, cleanPath);
        target.hash = token;
        location.href = target.href;
      } catch (e) {
        location.href = target.href;
      }
      return;
    }
    fails++; p.value = ""; p.focus();
    if (fails >= MAX) { until = Date.now() + LOCK_MS; ss("vlt_lock", String(until)); msg.textContent = "Zbyt wiele prob, odczekaj."; fails = 0; } else { msg.textContent = "Zle haslo."; }
  }

  btn.addEventListener("click", run);
  p.addEventListener("keyup", e => { if (e.key === "Enter") run(); });
})();
  </script></main></body></html>
  
